# This file contains the fastlane.tools configuration
# You can find the documentation at https://docs.fastlane.tools
#
# For a list of all available actions, check out
#
#     https://docs.fastlane.tools/actions
#
# For a list of all available plugins, check out
#
#     https://docs.fastlane.tools/plugins/available-plugins
#

# Uncomment the line if you want fastlane to automatically update itself
# update_fastlane

default_platform(:ios)

platform :ios do
  desc "æ³¨å†Œæ‰‹æœºudidåˆ°æŒ‡å®šAppIdè´¦å·"
  lane :addUdids do |option|
      #æ¥æ”¶åˆ°çš„æ‰€æœ‰å‚æ•°
      puts "æ¥æ”¶åˆ°çš„æ‰€æœ‰å‚æ•° #{option}"
      udidsStr = option[:udids]
      username = option[:appleid]
      if option.keys.size>0
         #å­—ç¬¦ä¸² -> æ•°ç»„
         udidsArray = udidsStr.split(",")
         puts "éœ€è¦æ·»åŠ çš„udidé›†åˆ #{udidsArray}"
         #æ•°ç»„ -> å­—å…¸ï¼ˆhashï¼‰
         udidsDic = {}
         for tmpUdid in udidsArray do
            tmpDic = {tmpUdid => tmpUdid}
            udidsDic = udidsDic.merge tmpDic
         end
         puts udidsDic
         #æ·»åŠ udid
         register_devices(
           devices:udidsDic,
           username: username
         )
      elsif
         puts "âš ï¸ âš ï¸ âš ï¸  udidsé›†åˆä¸ºç©º  âš ï¸ âš ï¸ âš ï¸"
      end
  end
 
  before_all  do |options|
     puts "ğŸš€ğŸš€ğŸš€ fastlane åˆå§‹åŒ–å‡†å¤‡æ‰§è¡Œ ğŸš€ğŸš€ğŸš€"
  end
  
  before_each  do |options|
     puts "ğŸš€ğŸš€ğŸš€ lane #{options}åˆå§‹åŒ–å‡†å¤‡æ‰§è¡Œ ğŸš€ğŸš€ğŸš€"
  end
  
  after_each  do |options|
     puts "ğŸš€ğŸš€ğŸš€ lane #{options}æ‰§è¡Œå®Œæˆ ğŸš€ğŸš€ğŸš€"
  end
  
  after_each  do |options|
     puts "ğŸš€ğŸš€ğŸš€ fastlane å®Œæˆæ‰§è¡Œ ğŸš€ğŸš€ğŸš€"
  end
  
  error  do |options|
     puts "âš ï¸ âš ï¸ âš ï¸  lane #{options}å‡ºç°é”™è¯¯  âš ï¸ âš ï¸ âš ï¸"
  end

end
